//************************************Stor products ******************************************* */
  let productsWomen = [
    {"id":1352054853,
    "img":"../assets/women/product5/Le-Dino-Lisse-Noir-01.jpg",
    "images":["../assets/women/product5/Le-Dino-Lisse-Noir-02.jpg ","../assets/women/product5/Le-Dino-Lisse-Noir-03.jpg"],
"name":"Le Dino Black Liégé",
"desc":"Italian leather hobo bag with zip and magnetic brass clasp. Compatible with A5/iPad Pro 11 format. Can be worn on the shoulder or carried in the hand. Magnetic pocket on the back. Inside flat pocket. Adjustable handle. Beige suede lining. Handmade in Italy.",
"price":440.00,
"color": [1, 2, 3],
"mayLike": [1, 2, 6],

},
    {"id":2315767263,
    "img":"../assets/women/product4/Le-Dino-Lisse-Ivoire-01.jpg",
    "images":["../assets/women/product4/Le-Dino-Lisse-Ivoire-02.jpg ","../assets/women/product4/Le-Dino-Lisse-Ivoire-03.jpg"],
"name":"Le Dino Ivory Liégé",
"desc":"Italian leather hobo bag with zip and magnetic brass clasp. Compatible with A5/iPad Pro 11 format. Can be worn on the shoulder or carried in the hand. Magnetic pocket on the back. Inside flat pocket. Adjustable handle. Beige suede lining. Handmade in Italy.",
"price":440.00,
        "color": [1, 2, 3],
"mayLike": [0, 5, 6],

},
    {"id":9554332882,
    "img":"../assets/women/product3/Grand-Nova-Lisse-Ivoire-013.jpg",
    "images":["../assets/women/product3/Grand-Nova-Lisse-Ivoire-02.jpg","../assets/women/product3/Grand-Nova-Lisse-Ivoire-3.jpg"],
"name":"Le Nova Ivory Liégé",
"desc":"Flap 'Box' bag in calfskin, with secure brass push clasp. Back pocket. Interior lined in suede. Long and adjustable shoulder strap included. Inside pocket with bellows.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [1, 3, 4],

},  {"id":7776803543,
    "img":"../assets/women/product17/Nova-Lisse-Noir-01_15f033c4-c0a8-48b4-ad1a-b9266c70e8cd.jpg",
    "images":["../assets/women/product17/Nova-Lisse-Noir-02_1c36d707-7e15-4519-9d6b-b95ed1ae65b3.jpg ","../assets/women/product17/Nova-Lisse-Noir-03_ce833484-6386-4c2d-8c3d-c0ad237848d7.jpg"],
"name":"Le Nova Black",
"desc":"Flap 'Box' bag in calfskin, with secure brass push clasp. Back pocket. Interior lined in suede. Long and adjustable shoulder strap included. Inside pocket with bellows.",
"price":420.00,
        "color": [1, 2, 4],
"mayLike": [2, 1, 8],

} , {"id":8066803543,
    "img":"./assets/women/product6/Le-Mini-Dalia-Lisse-Ivoire-01.jpg",
    "images":["../assets/women/product6/Le-Mini-Dalia-Lisse-Ivoire-02.jpg ","../assets/women/product6/Le-Mini-Dalia-Lisse-Ivoire-03.jpg"],
"name":"Le Mini Dalia Ivory Liégé",
"desc":"'Baguette' bag created in collaboration with Wendy Swan. Inspired by the Parisian and minimalist style of Wendy, this bag is constructed with 3 flexible gussets allowing a good capacity. Two shoulder straps for shoulder or cross-body carry. Optional short shoulder strap. XL smartphone compatible (ex iPhone 13 pro Max). Secure turnstile clasp, brass. Handmade in Italy.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},  {"id":3852779280,
    "img":"./assets/women/product1/Le-Mini-Dalia-Lisse-Noir-01.jpg ",
    "images":["../assets/women/product1/Le-Mini-Dalia-Lisse-Noir-04.jpg ","../assets/women/product1/Le-Mini-Dalia-Lisse-Noir-05.jpg .jpg"],
"name":"Le Mini Dalia Black Liégé",
"desc":"'Baguette' bag created in collaboration with Wendy Swan. Inspired by the Parisian and minimalist style of Wendy, this bag is constructed with 3 flexible gussets allowing a good capacity. Two shoulder straps for shoulder or cross-body carry. Optional short shoulder strap. XL smartphone compatible (ex iPhone 13 pro Max). Secure turnstile clasp, brass. Handmade in Italy.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

}, {"id":3852779900,
    "img":"./assets/women/product10/Le-Dalia-Bleu-Denim-Liege-01_fbe2bd3c-4b1d-461b-907a-c53310dd4a05.jpg",
    "images":["../assets/women/product10/Le-Dalia-Bleu-Denim-Liege-02_696a215e-c215-4ba4-8fc2-230b9635074f.jpg","../assets/women/product10/Le-Mini-Dalia-Lisse-Bleu-Denim-02_61384abc-4c6e-4d06-bc45-1844c2fd86c0.jpg"],
"name":"Le Dalia Blue Denim Liégé",
"desc":"'Baguette' bag created in collaboration with Wendy Swan. Inspired by the Parisian and minimalist style of Wendy, this bag is constructed with 3 flexible gussets allowing a good capacity. Two shoulder straps for shoulder or cross-body carry. Optional short shoulder strap. XL smartphone compatible (ex iPhone 13 pro Max). Secure turnstile clasp, brass. Handmade in Italy.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},
    {"id":3985779280,
    "img":"../assets/women/product11/Le-Dalia-Vert-Amande-Liege-01_fd1f3a45-a125-4340-b60a-a928d23a8407.jpg",
    "images":["../assets/women/product11/Le-Dalia-Vert-Amande-Liege-02_5268cd03-4838-4121-81d9-eaab4840da78.jpg ","../assets/women/product11/Le-Mini-Dalia-Lisse-Vert-Amande-02_c59fc4ba-c4d0-4a04-8cad-529a4d9fec40.jpg"],
"name":"Le Dalia Almond Green Liégé",
"desc":"'Baguette' bag created in collaboration with Wendy Swan. Inspired by the Parisian and minimalist style of Wendy, this bag is constructed with 3 flexible gussets allowing a good capacity. Two shoulder straps for shoulder or cross-body carry. Optional short shoulder strap. XL smartphone compatible (ex iPhone 13 pro Max). Secure turnstile clasp, brass. Handmade in Italy.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 6, 4],

},
    {"id":3852763280,
    "img":"./assets/women/product8/Elegant-Cuir-Miroir-Noir-01.jpg",
    "images":["../assets/women/product8/Elegant-Cuir-Miroir-Noir-02.jpg ","../assets/women/product8/Elegant-Cuir-Miroir-Noir-04.jpg"],
"name":"Le sac Elegant Black Patent Leather",
"desc":"50s inspired bag with brass clasp. Can be carried by hand or on the shoulder with its adjustable leather shoulder strap. Bi-material smooth leather and nubuck. A5 size compatible.",
"price":480.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},
    {"id":8965779280,
    "img":"./assets/women/product9/ipad-le-sac-elegant-1.jpg",
    "images":["../assets/women/product9/ipad-le-sac-elegant-4.jpg","../assets/women/product9/ipad-le-sac-elegant-5.jpg"],
"name":"Le sac Elegant Burgundy",
"desc":"50s inspired bag with brass clasp. Can be carried by hand or on the shoulder with its adjustable leather shoulder strap. Bi-material smooth leather and nubuck. A5 size compatible.",
"price":480.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},
    {"id":3852773330,
    "img":"../assets/women/product12/Petit-Violette-Lisse-Noir-01_364e68d6-d898-4732-8ae1-51c765fe5408.jpg",
    "images":["../assets/women/product12/Petit-Violette-Lisse-Noir-02_66bebc25-9fcc-498b-ad1f-cfd368452a01.jpg ","../assets/women/product12/Petit-Violette-Lisse-Noir-03_06eedd64-e3b9-4b93-b90e-ff3d198376be.jpg"],
"name":"Le Petit Violette Black",
"desc":"Minimalist bucket bag fully lined in leather. Can be carried by hand with its handle or on the shoulder with its leather shoulder strap. Detachable inner pocket. Sack bottom with metal studs.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},
    {"id":3852778989,
    "img":"./assets/women/product13/Petit-Violette-Lisse-Camel-01_060fb458-6ba4-4989-abb7-1d165a5b3aad.jpg",
    "images":["../assets/women/product13/Petit-Violette-Lisse-Camel-02_900x_253b27f1-9de9-4a12-bdae-1a38263828ae.jpg","../assets/women/product13/Petit-Violette-Lisse-Camel-03_dd67f66a-a8f6-455e-90b8-fe0ab2cb1358.jpg"],
"name":"Le Petit Violette Camel",
"desc":"Minimalist bucket bag fully lined in leather. Can be carried by hand with its handle or on the shoulder with its leather shoulder strap. Detachable inner pocket. Sack bottom with metal studs.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

      },
    {"id":2052778989,
    "img":"./assets/women/product15/Le-Gina-Bleu-Denim-Liege-01_4f490ce5-a7c6-40ba-9374-f288351dc3fc.jpg",
    "images":["../assets/women/product15/Le-Gina-Bleu-Denim-Liege-04_9bf1f40a-384d-4f51-8fc7-19dab125495a.jpg","../assets/women/product15/Le-Gina-Bleu-Denim-Liege-05_20c0b081-9bb7-4a56-bfe8-f9cd1474c8f0.jpg"],
"name":"Le Gina Blue Denim Liégé",
"desc":"Small Italian leather hobo bag with zip closure. Comes with two shoulder straps of different sizes to carry it crosswise or short, on the shoulder. Snap pocket on the back. Interior patch pocket. Beige suedette lining. Handmade in Italy.",
"price":320.00,
        "color": [1, 2, 4],
"mayLike": [13, 3, 4],

      },
    {"id":2032778989,
    "img":"./assets/women/product16/Le-Gina-Lisse-Ivoire-01_1d05ee86-9e6b-4819-a66a-790e1d4cae8e.jpg",
    "images":["../assets/women/product16/Le-Gina-Lisse-Ivoire-02_88508cc3-281e-456d-9e3f-d61186c8b6f9.jpg","../assets/women/product16/Le-Gina-Lisse-Ivoire-05_2900b2c4-9f06-45a2-87cb-3228ae21e94e.jpg"],
"name":"Le Gina Ivory Liégé",
"desc":"Small Italian leather hobo bag with zip closure. Comes with two shoulder straps of different sizes to carry it crosswise or short, on the shoulder. Snap pocket on the back. Interior patch pocket. Beige suedette lining. Handmade in Italy.",
"price":320.00,
        "color": [1, 2, 4],
"mayLike": [12, 3, 4],

      },
      {
          "id": 3852778580,
    "img":"./assets/women/product7/Dalia-Embosse-lezard-Camel-01.jpg",
    "images":["../assets/women/product7/Nova-Embosse-Lezard-Camel-02.jpg ","../assets/women/product7/Dalia-Embosse-lezard-Camel-03.jpg"],
"name":"Le Dalia Printed Lizard Camel",
"desc":"'Baguette' bag created in collaboration with Wendy Swan. Inspired by the Parisian and minimalist style of Wendy, this bag is constructed with 3 flexible gussets allowing a good capacity. Two shoulder straps for shoulder or cross-body carry. Optional short shoulder strap. XL smartphone compatible (ex iPhone 13 pro Max). Secure turnstile clasp, brass. Handmade in Italy.",
"price":380.00,
        "color": [1, 2, 4],
"mayLike": [2, 3, 4],

},
];
//*******************************select elements with class products and cart ************************ */
let main_prod = document.querySelector(".products")
let cartItems = document.getElementById("cartItems");
let cartTotal = document.getElementById("cartTotal");

// adding products

addProduct(productsWomen)
let cart = [];

//chech if there is products in localstorage
if (localStorage.getItem("cart")) {
    cart = JSON.parse(localStorage.getItem("cart"))
}
//update the cart HTML
getDataLocalStr();

//adding function
function addProduct (products){

    for (let i = 0; i < products.length; i++) {

        let imgProduct = document.createElement("img");
        let divProduct = document.createElement("div");
        let btnCont = document.createElement("div");
        let nameProduct =document.createElement("h3");
        let priceProducnt = document.createElement("h6");
        let more = document.createElement("button");
        let btnProducnt = document.createElement("i");
        let nameText =document.createTextNode(`${products[i].name}`);
        let priceText =document.createTextNode(`$${products[i].price}`);
        let moreTxt =document.createTextNode("show more");
        
        imgProduct.src= products[i].img;
        nameProduct.appendChild(nameText);
        priceProducnt.appendChild(priceText);
        more.appendChild(moreTxt);
        
        btnProducnt.classList.add("fa-solid", "fa-plus")  
        divProduct.setAttribute("class","product")
        divProduct.setAttribute("data-id",products[i].id)
        btnCont.setAttribute("class", "product_add")
        btnCont.setAttribute("data-id", products[i].id)
        imgProduct.setAttribute("class","product_img")
        nameProduct.setAttribute("class","product_name")
        priceProducnt.setAttribute("class", "product_price")
        more.setAttribute("class", "show_more")
        
        btnCont.appendChild(btnProducnt)
        divProduct.appendChild(imgProduct)
        divProduct.appendChild(nameProduct)
        divProduct.appendChild(priceProducnt)
        divProduct.appendChild(btnCont)
        divProduct.appendChild(more)
        main_prod.appendChild(divProduct)
    }

}

/*************************************Show user cart ******************************* */ 
let userCart = document.getElementById("userCart");
let addToCartBtn = document.querySelectorAll(".product_add");
let closeBtn = document.getElementById("closeBtn");
let showBtn = document.querySelector(".show_cart")


function addCart(products) {
    for (let i = 0; i < addToCartBtn.length; i++) {
        addToCartBtn[i].addEventListener('click', () => {
            //verify if the element already exist

            const findItem = cart.find(item => item.id == addToCartBtn[i].getAttribute("data-id"))
            const findItemBool = cart.find(item => item.id == addToCartBtn[i].getAttribute("data-id"))!== undefined ? true : false
            console.log('cart: ', cart);
            console.log('findItem: ', findItem);
            //increament quantity
            if (findItemBool) {
                findItem.quantity += 1;
            }
            //add element to cart
            else {
                let id = products[i].id
                let img = products[i].img
                let name = products[i].name;
                let price = products[i].price
                cart.push({
                    id,
                    img,
                    name,
                    price,
                    quantity: 1,
                })
            
            }
            //update the local storage with the new cart
            addDataToLocalSFrom(cart)
            //add it to HTML
            updateCart(cart)
            showCart()
        })

    }
}

addCart(productsWomen)

function showCart() {
    userCart.classList.add('show');
}

function hideCart() {
    userCart.classList.remove('show');
}
//removing cart if i click outside
window.addEventListener('click', (e) => {
    if (e.target === userCart) {
        hideCart();
    }
});
closeBtn.addEventListener('click',hideCart);


function updateCart(cart) {
    if (cart.length === 0) {
        cartItems.innerHTML = '<p class="text-gray-500 text-center py-4">Your cart is empty</p>';
    }else{
    cartItems.innerHTML= cart.map(item=>`        
        <div class="user_cart-item" data-id=${item.id}>
            <div>
                 <img src="${item.img}" class ="cart_img" alt="">
                <h3>${item.name}</h3>
                <p>Quantity: ${item.quantity}</p>
                </div>
                <div>  
                <p>$${(item.price * item.quantity).toFixed(2)}</p>
                <button 
                        class="remove-item remove_pro" 
                        aria-label="Remove item" data-id=${item.id} >Remove</button>
            </div>
           <hr>
        </div>  `).join('');

    
    }


    const total = cart.reduce((sum,item)=>{return sum+(item.price * item.quantity)},0)
    cartTotal.textContent = total.toFixed(2);
 let items = document.getElementsByClassName("user_cart-item")
for (let i = 0; i < items.length; i++) {
    items[i].addEventListener("click", (e) => {
        if (e.target.classList.contains("remove-item")) {
            removeFromCart(e.target.parentElement.parentElement.getAttribute("data-id"))        
            e.target.parentElement.parentElement.remove()
        }
    })
}
}
   

function removeFromCart(id) {
    cart = cart.filter((item) => {
        return item.id !=id
    });
    updateCart(cart);
   addDataToLocalSFrom(cart)
}
showBtn.onclick=()=>{
    showCart()
}

/****************************************LS********************************** */
function getDataLocalStr() {
    let data = window.localStorage.getItem("cart");
    if (data) {
        //array has data in local storage
        let arr = JSON.parse(data) 
        updateCart(arr)
    }
}
function addDataToLocalSFrom(cart) {
    window.localStorage.setItem("cart",JSON.stringify(cart))
}

/* styling */

let women_pro = document.querySelectorAll(".product")

//change main image when mouse overing
function changeImg(products) {
    let image = document.querySelectorAll(".product_img")
    for (let i = 0; i < products.length; i++) {
        products[i].addEventListener("mouseover", (e) => {
            if (e.target.classList.contains("product_img")) {
                image[i].src=`${productsWomen[i]["images"][0]}`
            }
        })
        products[i].addEventListener("mouseout", (e) => {
            if (e.target.classList.contains("product_img")) {
                image[i].src=`${productsWomen[i]["img"]}`
            }
        })
        
    }
}
//call function
changeImg(women_pro)
/****************************************description product************************ */
localStorage.setItem('WomanProducts', JSON.stringify(productsWomen));
 export function showDes(products) {
        for (let i = 0; i < products.length; i++) {
        
        products[i].addEventListener("click", function (e) {
                if (e.target.classList.contains("show_more")) {
                    localStorage.setItem('selectedProduct', JSON.stringify(productsWomen[i]));
                    let realtedProd = productsWomen[i].mayLike;
                    for (let j = 0; j < realtedProd.length; j++) {
                    localStorage.setItem(`realtedProd${j}`, JSON.stringify(productsWomen[realtedProd[j]]));
                        
                    }
                    
                    localStorage.setItem('selectedProduct', JSON.stringify(productsWomen[i]));
            
                    
                    location.href = "../showPr.html"

            }
        })
    }

}
showDes(women_pro)


//************************filtering*********************

const searchInput = document.getElementById('searchName');

const prod = document.querySelectorAll(".product")
function filterProducts(){
    //get the label input
    const searchTerm = searchInput.value.toLowerCase();
searchInput.style.backgroundColor = 'white';
    for (let i = 0; i < productsWomen.length; i++) {
        //show the element with the same name
        if(productsWomen[i].name.toLowerCase() === searchTerm){
            // let pr_id = productsWomen[i].id;
            prod[i].classList.remove('hidden');
            console.log("added")

        }
        //hide the element without the same name
        else{
            prod[i].classList.add('hidden');
        }
        
    }

}

searchInput.addEventListener('input', filterProducts);

searchInput.addEventListener('input', ()=>{
    const searchTerm = searchInput.value.toLowerCase();
    for (let i = 0; i < productsWomen.length; i++) {

            if(searchTerm =="")
                prod[i].classList.remove('hidden');
            
    }
    
});
searchInput.addEventListener('blur', () => {
    searchInput.style.backgroundColor="#2f332f"
});
searchInput.addEventListener('focus', () => {
    searchInput.style.backgroundColor="white"
});